<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìºì‹œ ì •ë¦¬ ë„êµ¬ - ì•ˆì „ë‚˜ì¹¨ë°˜</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #e74c3c;
            text-align: center;
            margin-bottom: 30px;
        }
        .step {
            margin: 20px 0;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .step h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin: 10px 0;
            transition: background 0.3s;
        }
        button:hover {
            background: #c0392b;
        }
        .success {
            background: #d5edd8;
            border-left-color: #27ae60;
            color: #27ae60;
        }
        .warning {
            background: #fdf2e9;
            border-left-color: #e67e22;
            color: #e67e22;
        }
        .log {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
            margin: 20px 0;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§¹ ìºì‹œ ì •ë¦¬ ë„êµ¬</h1>
        
        <div class="step">
            <h3>ğŸ”§ ê°œë°œìë¥¼ ìœ„í•œ ìºì‹œ ì •ë¦¬</h3>
            <p>ì½”ë“œ ë³€ê²½ì‚¬í•­ì´ ë°˜ì˜ë˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©í•˜ì„¸ìš”.</p>
        </div>

        <button onclick="clearAllCaches()">ğŸ—‘ï¸ ëª¨ë“  ìºì‹œ ì‚­ì œ ë° ìƒˆë¡œê³ ì¹¨</button>
        <button onclick="clearStorageOnly()">ğŸ“¦ ì €ì¥ì†Œë§Œ ì‚­ì œ (ìƒˆë¡œê³ ì¹¨ ì•ˆí•¨)</button>
        <button onclick="forceReloadApp()">ğŸ”„ ì•±ìœ¼ë¡œ ê°•ì œ ì´ë™</button>

        <div id="log" class="log" style="display: none;"></div>

        <div class="step warning">
            <h3>âš ï¸ ì£¼ì˜ì‚¬í•­</h3>
            <ul>
                <li>ë¡œê·¸ì¸ ì •ë³´ê°€ ì‚­ì œë©ë‹ˆë‹¤</li>
                <li>ì €ì¥ëœ ì–¸ì–´ ì„¤ì •ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤</li>
                <li>ì„ì‹œ ì €ì¥ëœ í¼ ë°ì´í„°ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤</li>
            </ul>
        </div>

        <div class="step">
            <h3>ğŸ“‹ ìˆ˜ë™ ì •ë¦¬ ë°©ë²•</h3>
            <p><strong>Chrome/Edge:</strong></p>
            <ol>
                <li>F12 â†’ ê°œë°œì ë„êµ¬ ì—´ê¸°</li>
                <li>ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ ìš°í´ë¦­</li>
                <li>"ìºì‹œ ë¹„ìš°ê¸° ë° í•˜ë“œ ìƒˆë¡œê³ ì¹¨" ì„ íƒ</li>
            </ol>
            
            <p><strong>ë˜ëŠ”:</strong></p>
            <ol>
                <li>Ctrl + Shift + Delete</li>
                <li>"ì¿ í‚¤ ë° ê¸°íƒ€ ì‚¬ì´íŠ¸ ë°ì´í„°" ì²´í¬</li>
                <li>"ìºì‹œëœ ì´ë¯¸ì§€ ë° íŒŒì¼" ì²´í¬</li>
                <li>ì‚­ì œ ì‹¤í–‰</li>
            </ol>
        </div>
    </div>

    <script>
        const log = document.getElementById('log');
        
        function logMessage(message, type = 'info') {
            log.style.display = 'block';
            const timestamp = new Date().toLocaleTimeString();
            const emoji = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸';
            log.textContent += `[${timestamp}] ${emoji} ${message}\n`;
            log.scrollTop = log.scrollHeight;
        }

        async function clearAllCaches() {
            logMessage('ìºì‹œ ì •ë¦¬ ì‹œì‘...');
            
            // Service Worker ìºì‹œ
            if ('caches' in window) {
                try {
                    const cacheNames = await caches.keys();
                    logMessage(`ë°œê²¬ëœ ìºì‹œ: ${cacheNames.length}ê°œ`);
                    await Promise.all(cacheNames.map(name => caches.delete(name)));
                    logMessage('Service Worker ìºì‹œ ì‚­ì œ ì™„ë£Œ', 'success');
                } catch (e) {
                    logMessage(`ìºì‹œ ì‚­ì œ ì˜¤ë¥˜: ${e.message}`, 'error');
                }
            }
            
            // Local Storage
            try {
                const localKeys = Object.keys(localStorage);
                logMessage(`LocalStorage í‚¤: ${localKeys.length}ê°œ`);
                localStorage.clear();
                logMessage('LocalStorage ì‚­ì œ ì™„ë£Œ', 'success');
            } catch (e) {
                logMessage(`LocalStorage ì˜¤ë¥˜: ${e.message}`, 'error');
            }
            
            // Session Storage
            try {
                const sessionKeys = Object.keys(sessionStorage);
                logMessage(`SessionStorage í‚¤: ${sessionKeys.length}ê°œ`);
                sessionStorage.clear();
                logMessage('SessionStorage ì‚­ì œ ì™„ë£Œ', 'success');
            } catch (e) {
                logMessage(`SessionStorage ì˜¤ë¥˜: ${e.message}`, 'error');
            }
            
            // ì¿ í‚¤
            const cookies = document.cookie.split(";");
            cookies.forEach(cookie => {
                const eqPos = cookie.indexOf("=");
                const name = eqPos > -1 ? cookie.substr(0, eqPos).trim() : cookie.trim();
                document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
            });
            logMessage(`ì¿ í‚¤ ${cookies.length}ê°œ ì‚­ì œ ì™„ë£Œ`, 'success');
            
            // IndexedDB
            if ('indexedDB' in window) {
                try {
                    const databases = await indexedDB.databases();
                    databases.forEach(db => {
                        indexedDB.deleteDatabase(db.name);
                        logMessage(`IndexedDB "${db.name}" ì‚­ì œ`);
                    });
                } catch (e) {
                    logMessage(`IndexedDB ì˜¤ë¥˜: ${e.message}`, 'error');
                }
            }
            
            logMessage('3ì´ˆ í›„ ì•±ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤...');
            setTimeout(() => {
                window.location.href = '/?cache_bust=' + Date.now();
            }, 3000);
        }

        function clearStorageOnly() {
            logMessage('ì €ì¥ì†Œë§Œ ì •ë¦¬ ì¤‘...');
            localStorage.clear();
            sessionStorage.clear();
            
            document.cookie.split(";").forEach(cookie => {
                const eqPos = cookie.indexOf("=");
                const name = eqPos > -1 ? cookie.substr(0, eqPos).trim() : cookie.trim();
                document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
            });
            
            logMessage('ì €ì¥ì†Œ ì •ë¦¬ ì™„ë£Œ', 'success');
        }

        function forceReloadApp() {
            logMessage('ì•±ìœ¼ë¡œ ê°•ì œ ì´ë™...');
            window.location.href = '/?force_reload=' + Date.now();
        }
    </script>
</body>
</html>